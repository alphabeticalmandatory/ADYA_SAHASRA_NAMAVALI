<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Merriweather&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .preview-container {
            position: sticky;
            top: 20px;
            height: fit-content;
        }
        h1 {
            color: #6e0d25;
            text-align: center;
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 150px;
            resize: vertical;
            font-family: monospace;
        }
        button {
            background: linear-gradient(to right, #3b0a0a, #6e0d25);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }
        button:hover {
            opacity: 0.9;
        }
        .preview-image {
            width: 100%;
            max-width: 700px;
            height: auto;
            border-top-left-radius: 16px;
            border-bottom-right-radius: 16px;
            margin: 0 auto;
            display: block;
        }
        .preview-title {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            padding: 0.4rem 0.5rem;
            margin-top: -5px;
            background: linear-gradient(to right, #3b0a0a, #6e0d25);
            color: white;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            border-bottom-left-radius: 12px;
            border-bottom-right-radius: 12px;
            font-family: 'Cinzel Decorative', serif;
            letter-spacing: 0.5px;
        }
        .preview-blockquote {
            font-style: italic;
            color: #555;
            font-size: 1.1rem;
            font-family: 'Merriweather', serif;
            margin: 1.2rem auto;
            max-width: 650px;
            border-left: 4px solid #6e0d25;
            padding-left: 1rem;
            background: #fdf6f7;
            white-space: pre-line;
            line-height: 1.8;
        }
        .preview-description {
            max-width: 700px;
            margin: 1.2rem auto;
            font-size: 1.05rem;
            line-height: 1.8;
            font-family: 'Merriweather', serif;
            color: #333;
            padding: 0 0.5rem;
            white-space: pre-line;
        }
        .preview-pagination {
            text-align: center;
            margin-top: 2rem;
        }
        .preview-pagination a {
            color: #6e0d25;
            text-decoration: none;
            font-weight: bold;
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Markdown Generator</h1>
        
        <div class="form-group">
            <label for="fileNumber">File Number:</label>
            <input type="number" id="fileNumber" placeholder="e.g., 431" min="1">
        </div>
        
        <div class="form-group">
            <label for="imageLink">Image Link:</label>
            <input type="url" id="imageLink" placeholder="https://example.com/image.jpg">
        </div>
        
        <div class="form-group">
            <label for="title">Title (without number):</label>
            <input type="text" id="title" placeholder="e.g., MANYA">
        </div>
        
        <div class="form-group">
            <label for="subtitle">Subtitle:</label>
            <textarea id="subtitle" placeholder="The One who is..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="description">Description (maintain line breaks):</label>
            <textarea id="description" placeholder="Devi Kaalika..."></textarea>
        </div>
        
        <button id="generateBtn">Generate & Download Markdown</button>
    </div>
    
    <div class="container preview-container">
        <h1>Live Preview</h1>
        <div id="livePreview">
            <p>Preview will appear here as you type...</p>
        </div>
    </div>

    <script>
        const fileNumberInput = document.getElementById('fileNumber');
        const imageLinkInput = document.getElementById('imageLink');
        const titleInput = document.getElementById('title');
        const subtitleInput = document.getElementById('subtitle');
        const descriptionInput = document.getElementById('description');
        const generateBtn = document.getElementById('generateBtn');
        const livePreview = document.getElementById('livePreview');
        
        // Handle hash-based navigation
        window.addEventListener('hashchange', loadFromHash);
        window.addEventListener('load', loadFromHash);

        function loadFromHash() {
            const hash = window.location.hash.replace('#/', '');
            if (hash && !isNaN(hash)) {
                fileNumberInput.value = hash;
                updatePreview();
            }
        }

        [fileNumberInput, imageLinkInput, titleInput, subtitleInput, descriptionInput].forEach(input => {
            input.addEventListener('input', updatePreview);
        });
        
        function updatePreview() {
            const fileNumber = fileNumberInput.value;
            // Update URL without page reload
            if (fileNumber) history.replaceState(null, null, `#/${fileNumber}`);
            
            const imageLink = imageLinkInput.value;
            const title = titleInput.value.trim().replace(/\s+/g, ' ');
            const subtitle = subtitleInput.value.trim().replace(/\n\n+/g, '\n');
            const description = processDescription(descriptionInput.value.trim().replace(/\n\n+/g, '\n'));
            
            let previewHTML = '';
            
            if (imageLink) {
                previewHTML += `
                <p align="center">
                    <img src="${imageLink}" alt="${fileNumber}. ${title}" class="preview-image">
                </p>`;
            }
            
            if (fileNumber && title) {
                previewHTML += `
                <div class="preview-title">
                    ${fileNumber}. ${title}
                </div>`;
            }
            
            if (subtitle) {
                previewHTML += `
                <blockquote class="preview-blockquote">
                    ${subtitle.replace(/\n/g, '<br>')}
                </blockquote>`;
            }
            
            if (description) {
                previewHTML += `
                <div class="preview-description">
                    ${description.replace(/\n/g, '<br>')}
                </div>`;
            }
            
            if (fileNumber) {
                const prevNumber = parseInt(fileNumber) - 1;
                const nextNumber = parseInt(fileNumber) + 1;
                previewHTML += `
                <p align="center" class="preview-pagination">
                    <a class="arrow-link" href="#/${prevNumber}">← ${prevNumber}</a>
                    <a class="arrow-link" href="#/${nextNumber}">${nextNumber} →</a>
                </p>`;
            }
            
            livePreview.innerHTML = previewHTML || '<p>Preview will appear here as you type...</p>';
        }
        
        function processDescription(text) {
            return text.split('\n')
                .filter(line => !line.trim().startsWith('#'))
                .join('\n');
        }
        
        generateBtn.addEventListener('click', () => {
            const fileNumber = fileNumberInput.value;
            const imageLink = imageLinkInput.value;
            const title = titleInput.value.trim().replace(/\s+/g, ' ');
            const subtitle = subtitleInput.value.trim().replace(/\n\n+/g, '\n');
            const description = processDescription(descriptionInput.value.trim().replace(/\n\n+/g, '\n'));
            
            if (!fileNumber || !title) {
                alert('Please enter both file number and title');
                return;
            }
            
            let mdContent = `<!-- Load Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Merriweather&display=swap" rel="stylesheet">

<!-- ${fileNumber}. ${title} - Devi Kalika -->

<p align="center">
  <img 
    src="${imageLink}" 
    alt="${fileNumber}. ${title}" 
    style="
      width: 100%;
      max-width: 700px;
      height: auto;
      border-top-left-radius: 16px;
      border-bottom-right-radius: 16px;
      display: block;
      margin: auto;
    " 
  />
</p>

<div style="
  text-align: center;
  font-size: 2rem;
  font-weight: bold;
  padding: 0.4rem 0.5rem;
  margin-top: -5px;
  background: linear-gradient(to right, #3b0a0a, #6e0d25);
  color: white;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
  border-bottom-left-radius: 12px;
  border-bottom-right-radius: 12px;
  font-family: 'Cinzel Decorative', serif;
  letter-spacing: 0.5px;
">
  ${fileNumber}. ${title}
</div>

<blockquote style="
  font-style: italic;
  color: #555;
  font-size: 1.1rem;
  font-family: 'Merriweather', serif;
  margin: 1.2rem auto;
  max-width: 650px;
  border-left: 4px solid #6e0d25;
  padding-left: 1rem;
  background: #fdf6f7;
  white-space: pre-line;
  line-height: 1.8;
">
${subtitle.replace(/\n/g, '\n')}
</blockquote>

<div style="
  max-width: 700px;
  margin: 1.2rem auto;
  font-size: 1.05rem;
  line-height: 1.8;
  font-family: 'Merriweather', serif;
  color: #333;
  padding: 0 0.5rem;
  white-space: pre-line;
">
${description.replace(/\n/g, '\n')}
</div>

<p align="center" style="margin-top:2rem;">
  <a class="arrow-link" href="#/${parseInt(fileNumber)-1}">← ${parseInt(fileNumber)-1}</a>
  <a class="arrow-link" href="#/${parseInt(fileNumber)+1}">${parseInt(fileNumber)+1} →</a>
</p>`;
            
            const blob = new Blob([mdContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${fileNumber}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
        
        updatePreview();
    </script>
</body>
  </html>
